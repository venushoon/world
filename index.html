<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ‡«ğŸ‡· í”„ë‘ìŠ¤ ë©”ëª¨ë¦¬ ê²Œì„ â€” ë‚œì´ë„/ì½¤ë³´/ì‚¬ìš´ë“œ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { --blue:#2563eb; --red:#ef4444; }
    body { background: linear-gradient(180deg,#f8fafc 0%,#eef2ff 100%); }
    .board { max-width: 1400px; }
    .perspective { perspective: 1200px; }
    .card { width: 180px; height: 140px; }
    .inner { position: relative; width: 100%; height: 100%; transform-style: preserve-3d; transform-origin: center center; }
    .card.flipped .inner { transform: rotateY(180deg); }
    .face { position: absolute; inset: 0; width: 100%; height: 100%; backface-visibility: hidden; -webkit-backface-visibility: hidden; }
    .front {
      background: radial-gradient(120% 120% at 0% 0%, rgba(37,99,235,.15) 0%, transparent 60%),
                  radial-gradient(120% 120% at 100% 100%, rgba(239,68,68,.15) 0%, transparent 60%),
                  white;
    }
    .back { transform: rotateY(180deg); }
    .flag-strip::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 6px;
      background: linear-gradient(90deg,#1d4ed8 0 33%,#fff 33% 66%,#dc2626 66% 100%);
      border-top-left-radius: .75rem; border-top-right-radius: .75rem; }
    .shadow-soft { box-shadow: 0 10px 20px rgba(2,6,23,.08), 0 6px 6px rgba(2,6,23,.06); }
    @media (max-width: 1180px) { .card { width: 160px; height: 120px; } }
  </style>
</head>
<body class="min-h-screen py-8 text-slate-800">
  <main class="mx-auto board px-4">
    <header class="flex flex-col md:flex-row md:items-end md:justify-between gap-4 mb-4">
      <div>
        <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight text-slate-900">ğŸ‡«ğŸ‡· í”„ë‘ìŠ¤ ë©”ëª¨ë¦¬ ê²Œì„</h1>
        <p class="text-slate-600 mt-1">ì‚¬ì§„ ì¹´ë“œì™€ ë‚±ë§ ì¹´ë“œë¥¼ ì§ì§€ì–´ ë³´ì„¸ìš”! (2í–‰ Ã— 5ì—´, ì´ 10ì¥)</p>
      </div>
      <div class="flex flex-wrap items-center gap-3">
        <label class="text-sm text-slate-600">ì„¸íŠ¸
          <select id="dataset" class="ml-2 px-3 py-2 rounded-xl bg-white ring-1 ring-slate-200 shadow-soft">
            <option value="classic">ëŒ€í‘œ (í˜¼í•©)</option>
            <option value="art">ì˜ˆìˆ  ì¤‘ì‹¬</option>
            <option value="landmarks">ëœë“œë§ˆí¬ ì¤‘ì‹¬</option>
            <option value="food">ìŒì‹ í¬í•¨</option>
          </select>
        </label>
        <label class="text-sm text-slate-600">ë‚œì´ë„
          <select id="difficulty" class="ml-2 px-3 py-2 rounded-xl bg-white ring-1 ring-slate-200 shadow-soft">
            <option value="5">ë³´í†µ (10ì¥)</option>
            <option value="6">ì–´ë ¤ì›€ (12ì¥)</option>
            <option value="8">ë§¤ìš° ì–´ë ¤ì›€ (16ì¥)</option>
          </select>
        </label>
        <label class="text-sm text-slate-600">ì œí•œì‹œê°„
          <select id="timelimit" class="ml-2 px-3 py-2 rounded-xl bg-white ring-1 ring-slate-200 shadow-soft">
            <option value="60">60ì´ˆ</option>
            <option value="90" selected>90ì´ˆ</option>
            <option value="120">120ì´ˆ</option>
            <option value="0">ë¬´ì œí•œ</option>
          </select>
        </label>
        <button id="btn-new" class="px-4 py-2 rounded-xl bg-slate-900 text-white font-semibold shadow-soft hover:opacity-90 active:opacity-80">ìƒˆ ê²Œì„</button>
        <button id="btn-hint" class="px-4 py-2 rounded-xl bg-white ring-1 ring-slate-200 font-semibold shadow-soft hover:bg-slate-50">ì •ë‹µ íŒíŠ¸ (3ì´ˆ)</button>
      </div>
    </header>

    <section class="flex items-center flex-wrap gap-6 mb-3">
      <div class="flex items-center gap-2 text-slate-700"><span class="text-sm">ì´ë™ ìˆ˜:</span><span id="moves" class="text-lg font-bold">0</span></div>
      <div class="flex items-center gap-2 text-slate-700"><span class="text-sm">ì„±ê³µ ìŒ:</span><span id="matches" class="text-lg font-bold">0/5</span></div>
      <div class="flex items-center gap-2 text-slate-700"><span class="text-sm">ì½¤ë³´:</span><span id="combo" class="text-lg font-bold">x0</span></div>
      <div class="flex items-center gap-2 text-slate-700"><span class="text-sm">ì ìˆ˜:</span><span id="score" class="text-lg font-bold">0</span></div>
      <div class="flex items-center gap-2 text-slate-700"><span class="text-sm">ë‚¨ì€ ì‹œê°„:</span><span id="time" class="text-lg font-bold">âˆ</span></div>
      <div class="ml-auto text-sm text-slate-500">ì •ë‹µ +10ì  + ì½¤ë³´ë³´ë„ˆìŠ¤(<span class="font-semibold">+5Ã—ì½¤ë³´ë‹¨ê³„</span>), ì˜¤ë‹µ âˆ’2ì </div>
    </section>

    <section id="board" class="grid gap-4 place-items-center"></section>

    <footer class="mt-6 text-sm text-slate-500">
      ì„¸íŠ¸ êµ¬ì„±ì€ ìƒë‹¨ ë“œë¡­ë‹¤ìš´ì—ì„œ ì„ íƒí•˜ì„¸ìš”. ì´ë¯¸ì§€ ë§í¬ëŠ” êµìœ¡ ëª©ì  ì˜ˆì‹œì´ë©°, í•„ìš” ì‹œ í•™êµ ë‚´ë¶€ ì„œë²„/êµ¬ê¸€ë“œë¼ì´ë¸Œ URLë¡œ êµì²´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
    </footer>
  </main>

  <template id="tpl-card">
    <button class="card relative perspective rounded-2xl focus:outline-none focus:ring-4 ring-indigo-200 shadow-soft group" aria-label="ì¹´ë“œ">
      <div class="inner w-full h-full transition-transform duration-300">
        <div class="face front w-full h-full rounded-2xl flex items-center justify-center flag-strip">
          <div class="text-center">
            <div class="text-2xl">ğŸƒ</div>
            <div class="mt-1 text-sm text-slate-500">ë’¤ì§‘ì–´ ë³´ì„¸ìš”</div>
          </div>
        </div>
        <div class="face back w-full h-full rounded-2xl bg-white flex items-center justify-center p-3"></div>
      </div>
    </button>
  </template>

  <script>
    // ===== ë°ì´í„° ì„¸íŠ¸ (í•„ìš” ì‹œ ì´ë¯¸ì§€ URL êµì²´) =====
    const DATASETS = {
      classic: [
        { id:'eiffel', ko:'ì—í íƒ‘', hint:'Tour Eiffel', img:'https://upload.wikimedia.org/wikipedia/commons/a/a8/Tour_Eiffel_Wikimedia_Commons.jpg' },
        { id:'mona', ko:'ëª¨ë‚˜ë¦¬ì', hint:'Mona Lisa', img:'https://upload.wikimedia.org/wikipedia/commons/6/6a/Mona_Lisa.jpg' },
        { id:'louvre', ko:'ë£¨ë¸Œë¥´ ë°•ë¬¼ê´€', hint:'MusÃ©e du Louvre', img:'https://upload.wikimedia.org/wikipedia/commons/a/af/Louvre_Museum_Wikimedia_Commons.jpg' },
        { id:'arc', ko:'ê°œì„ ë¬¸', hint:'Arc de Triomphe', img:'https://upload.wikimedia.org/wikipedia/commons/6/6d/Arc_de_Triomphe_Paris_Wikimedia_Commons.jpg' },
        { id:'versailles', ko:'ë² ë¥´ì‚¬ìœ  ê¶ì „', hint:'Palais de Versailles', img:'https://upload.wikimedia.org/wikipedia/commons/5/5d/Palace_of_Versailles_Wikimedia_Commons.jpg' },
        { id:'notre', ko:'ë…¸íŠ¸ë¥´ë‹´ ëŒ€ì„±ë‹¹', hint:'Notre-Dame', img:'https://upload.wikimedia.org/wikipedia/commons/a/a6/Notre_Dame_de_Paris_2013-07-24.jpg' },
        { id:'mont', ko:'ëª½ìƒë¯¸ì…¸', hint:'Mont-Saint-Michel', img:'https://upload.wikimedia.org/wikipedia/commons/0/02/Mont-Saint-Michel_from_above.jpg' },
        { id:'chambord', ko:'ìƒ¹ë³´ë¥´ ì„±', hint:'ChÃ¢teau de Chambord', img:'https://upload.wikimedia.org/wikipedia/commons/8/89/Chateau_Chambord.jpg' }
      ],
      art: [
        { id:'mona', ko:'ëª¨ë‚˜ë¦¬ì', hint:'Mona Lisa', img:'https://upload.wikimedia.org/wikipedia/commons/6/6a/Mona_Lisa.jpg' },
        { id:'venus', ko:'ì‚¬ëª¨íŠ¸ë¼ì¼€ì˜ ë‹ˆì¼€', hint:'Winged Victory', img:'https://upload.wikimedia.org/wikipedia/commons/3/3c/Winged_Victory_of_Samothrace_-_Louvre.jpg' },
        { id:'milov', ko:'ë°€ë¡œì˜ ë¹„ë„ˆìŠ¤', hint:'Venus de Milo', img:'https://upload.wikimedia.org/wikipedia/commons/7/7d/Venus_de_Milo_Louvre_Ma399_n4.jpg' },
        { id:'orsee', ko:'ì˜¤ë¥´ì„¸ ë¯¸ìˆ ê´€', hint:"MusÃ©e d'Orsay", img:'https://upload.wikimedia.org/wikipedia/commons/1/1e/Mus%C3%A9e_d%27Orsay_Inside.jpg' },
        { id:'monet', ko:'ìˆ˜ë ¨', hint:'Monet Water Lilies', img:'https://upload.wikimedia.org/wikipedia/commons/2/2e/Monet_Water_Lilies_1916.jpg' },
        { id:'rodin', ko:'ìƒê°í•˜ëŠ” ì‚¬ëŒ', hint:'Rodin The Thinker', img:'https://upload.wikimedia.org/wikipedia/commons/5/5f/Le_Penseur_de_Rodin.jpg' },
        { id:'delacroix', ko:'ë¯¼ì¤‘ì„ ì´ë„ëŠ” ììœ ì˜ ì—¬ì‹ ', hint:'Delacroix', img:'https://upload.wikimedia.org/wikipedia/commons/4/4d/Eug%C3%A8ne_Delacroix_-_La_libert%C3%A9_guidant_le_peuple.jpg' },
        { id:'giverny', ko:'ì§€ë² ë¥´ë‹ˆ ì •ì›', hint:'Giverny Garden', img:'https://upload.wikimedia.org/wikipedia/commons/1/12/Monet%27s_garden_in_Giverny_2012.jpg' }
      ],
      landmarks: [
        { id:'eiffel', ko:'ì—í íƒ‘', hint:'Tour Eiffel', img:'https://upload.wikimedia.org/wikipedia/commons/a/a8/Tour_Eiffel_Wikimedia_Commons.jpg' },
        { id:'notre', ko:'ë…¸íŠ¸ë¥´ë‹´ ëŒ€ì„±ë‹¹', hint:'Notre-Dame', img:'https://upload.wikimedia.org/wikipedia/commons/a/a6/Notre_Dame_de_Paris_2013-07-24.jpg' },
        { id:'mont', ko:'ëª½ìƒë¯¸ì…¸', hint:'Mont-Saint-Michel', img:'https://upload.wikimedia.org/wikipedia/commons/0/02/Mont-Saint-Michel_from_above.jpg' },
        { id:'arc', ko:'ê°œì„ ë¬¸', hint:'Arc de Triomphe', img:'https://upload.wikimedia.org/wikipedia/commons/6/6d/Arc_de_Triomphe_Paris_Wikimedia_Commons.jpg' },
        { id:'versailles', ko:'ë² ë¥´ì‚¬ìœ  ê¶ì „', hint:'Palais de Versailles', img:'https://upload.wikimedia.org/wikipedia/commons/5/5d/Palace_of_Versailles_Wikimedia_Commons.jpg' },
        { id:'sacre', ko:'ì‚¬í¬ë ˆì¾¨ë¥´ ëŒ€ì„±ë‹¹', hint:'SacrÃ©-CÅ“ur', img:'https://upload.wikimedia.org/wikipedia/commons/6/6b/Sacre_Coeur_2011.jpg' },
        { id:'pontgard', ko:'íë’¤ê°€ë¥´', hint:'Pont du Gard', img:'https://upload.wikimedia.org/wikipedia/commons/7/77/Pont_du_Gard_BLS.jpg' },
        { id:'carcassonne', ko:'ì¹´ë¥´ì¹´ì†', hint:'CitÃ© de Carcassonne', img:'https://upload.wikimedia.org/wikipedia/commons/7/70/Carcassonne_Cit%C3%A9_Walls.jpg' }
      ],
      food: [
        { id:'baguette', ko:'ë°”ê²ŒíŠ¸', hint:'Baguette', img:'https://upload.wikimedia.org/wikipedia/commons/3/34/French_baguettes.jpg' },
        { id:'macaron', ko:'ë§ˆì¹´ë¡±', hint:'Macaron', img:'https://upload.wikimedia.org/wikipedia/commons/0/0e/Macarons_in_Patisserie.jpg' },
        { id:'cheese', ko:'í”„ë‘ìŠ¤ ì¹˜ì¦ˆ', hint:'Fromage', img:'https://upload.wikimedia.org/wikipedia/commons/3/36/French_cheese_assortment.jpg' },
        { id:'crepe', ko:'í¬ë ˆí˜', hint:'CrÃªpe', img:'https://upload.wikimedia.org/wikipedia/commons/4/4b/Crepes_dsc07085.jpg' },
        { id:'ratatouille', ko:'ë¼ë”°ëšœì´', hint:'Ratatouille', img:'https://upload.wikimedia.org/wikipedia/commons/5/50/Ratatouille.jpg' },
        { id:'louvre', ko:'ë£¨ë¸Œë¥´ ë°•ë¬¼ê´€', hint:'MusÃ©e du Louvre', img:'https://upload.wikimedia.org/wikipedia/commons/a/af/Louvre_Museum_Wikimedia_Commons.jpg' },
        { id:'eiffel', ko:'ì—í íƒ‘', hint:'Tour Eiffel', img:'https://upload.wikimedia.org/wikipedia/commons/a/a8/Tour_Eiffel_Wikimedia_Commons.jpg' },
        { id:'mont', ko:'ëª½ìƒë¯¸ì…¸', hint:'Mont-Saint-Michel', img:'https://upload.wikimedia.org/wikipedia/commons/0/02/Mont-Saint-Michel_from_above.jpg' }
      ]
    };

    // ===== ì‚¬ìš´ë“œ(ì›¹ ì˜¤ë””ì˜¤ë¡œ ê²½ëŸ‰ í†¤ ìƒì„±) =====
    let audioCtx;
    function beep(freq=660, dur=120, type='sine', vol=.2){
      if(!audioCtx) audioCtx = new (window.AudioContext||window.webkitAudioContext)();
      const o = audioCtx.createOscillator();
      const g = audioCtx.createGain();
      o.type = type; o.frequency.value = freq;
      g.gain.value = vol; o.connect(g); g.connect(audioCtx.destination);
      o.start(); setTimeout(()=>{ o.stop(); }, dur);
    }
    const sfx = {
      flip: () => beep(700, 70, 'triangle', .07),
      match: () => { beep(520, 90, 'sine', .15); setTimeout(()=>beep(780, 120,'sine', .15), 90); },
      wrong: () => { beep(220, 130, 'sawtooth', .08); },
      win: () => { [523,659,784].forEach((f,i)=> setTimeout(()=>beep(f,120,'sine',.18), i*140)); },
      timeup: () => { [400,300,220].forEach((f,i)=> setTimeout(()=>beep(f,180,'square',.15), i*200)); }
    };

    // ----- ìœ í‹¸ -----
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => [...el.querySelectorAll(sel)];
    const shuffle = (arr) => { const a = [...arr]; for (let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; };
    function placeholderDataURL(label){
      const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='400' height='300'>
        <rect width='100%' height='100%' fill='#e5e7eb'/>
        <text x='50%' y='50%' text-anchor='middle' dominant-baseline='middle' font-family='sans-serif' font-size='24' fill='#111827'>${label}</text>
      </svg>`;
      return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
    }

    // ----- ìƒíƒœ -----
    let deck = [];
    let first = null, second = null, lock = false;
    let moves = 0, matches = 0, score = 0;
    let combo = 0; // ì—°ì†ì •ë‹µ ì½¤ë³´
    let pairTarget = 5; // ë‚œì´ë„ì— ë”°ë¥¸ ëª©í‘œ ìŒ ìˆ˜
    let timer = null, remain = 0;

    function buildDeck(datasetKey){
      const src = DATASETS[datasetKey] || DATASETS.classic;
      const need = pairTarget;
      const chosen = src.slice(0, need);
      const pairs = chosen.flatMap(item => ([
        { pair:item.id, kind:'image', label:item.ko, hint:item.hint, img:item.img },
        { pair:item.id, kind:'word',  label:item.ko, hint:item.hint }
      ]));
      return shuffle(pairs);
    },
        { pair:item.id, kind:'word',  label:item.ko, hint:item.hint }
      ]));
      return shuffle(pairs);
    }

    function preloadImages(list){ list.filter(c=>c.kind==='image').forEach(c=>{ const im=new Image(); im.src=c.img; }); }

    function updateHUD(){
      $('#moves').textContent = moves;
      $('#matches').textContent = `${matches}/${pairTarget}`;
      $('#combo').textContent = `x${combo}`;
      $('#score').textContent = score;
      $('#time').textContent = (remain===Infinity) ? 'âˆ' : `${remain}s`;
    }/5`;
      $('#score').textContent = score;
      $('#time').textContent = (remain===Infinity) ? 'âˆ' : `${remain}s`;
    }

    function createCardEl(card, index){
      const tpl = document.getElementById('tpl-card');
      const el = tpl.content.firstElementChild.cloneNode(true);
      el.dataset.pair = card.pair;
      el.dataset.kind = card.kind;
      el.dataset.index = index;
      el.setAttribute('aria-label', card.kind==='image' ? `${card.label} ì‚¬ì§„ ì¹´ë“œ` : `${card.label} ë‹¨ì–´ ì¹´ë“œ`);

      const back = $('.back', el);
      if(card.kind === 'image'){
        const img = document.createElement('img');
        img.src = card.img; img.alt = card.label + ' ì‚¬ì§„'; img.loading='lazy';
        img.className = 'max-h-[110px] object-cover rounded-lg shadow-inner';
        img.onerror = () => { img.src = placeholderDataURL(card.label); };
        back.appendChild(img);
      } else {
        const box = document.createElement('div'); box.className='text-center';
        const main = document.createElement('div'); main.className='text-lg font-bold'; main.textContent = card.label;
        const sub = document.createElement('div'); sub.className='text-xs text-slate-500 mt-1'; sub.textContent = card.hint || '';
        box.appendChild(main); box.appendChild(sub); back.appendChild(box);
      }
      el.addEventListener('click', () => onFlip(el));
      return el;
    }

    function render(){
      const board = document.getElementById('board');
      board.innerHTML = '';
      // 2í–‰ ê³ ì •, ì—´ ìˆ˜ = pairTarget
      board.style.gridTemplateColumns = `repeat(${pairTarget}, minmax(0, 1fr))`;
      // ì¹´ë“œ í¬ê¸° ìë™ ì¡°ì ˆ(ì—´ì´ ë§ì•„ì§€ë©´ ì‚´ì§ ì‘ê²Œ)
      const sizeClass = pairTarget >= 8 ? 'w-[150px] h-[115px]' : pairTarget >= 6 ? 'w-[165px] h-[125px]' : 'w-[180px] h-[140px]';
      deck.forEach((c,i)=> {
        const el = createCardEl(c,i);
        el.classList.add(...sizeClass.split(' '));
        board.appendChild(el);
      });
    }

    function onFlip(el){
      if(lock || el.classList.contains('matched') || el.classList.contains('flipped')) return;
      el.classList.add('flipped'); sfx.flip();
      if(!first){ first = el; return; }
      second = el; lock = true; moves++; updateHUD();

      const isMatch = first.dataset.pair === second.dataset.pair && first.dataset.kind !== second.dataset.kind;
      if(isMatch){
        setTimeout(()=>{
          first.classList.add('matched'); second.classList.add('matched');
          first.setAttribute('disabled','true'); second.setAttribute('disabled','true');
          first = second = null; lock = false; matches++; combo++; score += 10 + (Math.max(0, combo-1))*5; updateHUD(); sfx.match();
          if(matches === pairTarget) win();
        }, 260);
      } else {
        setTimeout(()=>{
          first.classList.remove('flipped'); second.classList.remove('flipped');
          first = second = null; lock = false; score = Math.max(0, score - 2); combo = 0; updateHUD(); sfx.wrong();
        }, 800);
      }, 800);
      }
    }

    function win(){
      stopTimer(); sfx.win();
      const msg = document.createElement('div');
      msg.className = 'fixed inset-0 flex items-center justify-center bg-black/20';
      msg.innerHTML = `
        <div class='bg-white rounded-2xl p-6 shadow-soft text-center'>
          <div class='text-3xl mb-2'>ğŸ‰ ì„±ê³µ!</div>
          <p class='text-slate-600 mb-4'>ëª¨ë“  ì§ì„ ì°¾ì•˜ì–´ìš”. ì ìˆ˜ <span class="font-bold">${score}</span>ì , ì´ë™ìˆ˜ <span class="font-bold">${moves}</span>íšŒ, ìµœê³  ì½¤ë³´ <span class="font-bold">${combo}</span>x</p>
          <button id='btn-close' class='px-4 py-2 rounded-xl bg-slate-900 text-white font-semibold hover:opacity-90'>ë‹¤ì‹œ í•˜ê¸°</button>
        </div>`;
      document.body.appendChild(msg);
      $('#btn-close', msg).addEventListener('click', () => { document.body.removeChild(msg); newGame(); });
    }

    function timeUp(){
      sfx.timeup();
      const msg = document.createElement('div');
      msg.className = 'fixed inset-0 flex items-center justify-center bg-black/30';
      msg.innerHTML = `
        <div class='bg-white rounded-2xl p-6 shadow-soft text-center'>
          <div class='text-3xl mb-2'>â° ì‹œê°„ ì¢…ë£Œ</div>
          <p class='text-slate-600 mb-4'>ì ìˆ˜ <span class="font-bold">${score}</span>ì , ì„±ê³µ <span class="font-bold">${matches}</span>/5</p>
          <button id='btn-close2' class='px-4 py-2 rounded-xl bg-slate-900 text-white font-semibold hover:opacity-90'>ë‹¤ì‹œ í•˜ê¸°</button>
        </div>`;
      document.body.appendChild(msg);
      $('#btn-close2', msg).addEventListener('click', () => { document.body.removeChild(msg); newGame(); });
    }

    function startTimer(seconds){
      stopTimer();
      if(seconds === 0){ remain = Infinity; updateHUD(); return; }
      remain = seconds; updateHUD();
      timer = setInterval(()=>{
        if(remain===Infinity) return; remain--; updateHUD();
        if(remain <= 0){ stopTimer(); lock = true; $$('#board .card').forEach(el=>el.setAttribute('disabled','true')); timeUp(); }
      }, 1000);
    }
      remain = seconds; updateHUD();
      timer = setInterval(()=>{
        if(remain===Infinity) return; remain--; updateHUD();
        if(remain <= 0){ stopTimer(); // ë³´ë“œ ì ê¸ˆ
          lock = true; $$('#board .card').forEach(el=>el.setAttribute('disabled','true'));
          timeUp();
        }
      }, 1000);
    }
    function stopTimer(){ if(timer){ clearInterval(timer); timer=null; } }

    function hint3sec(){
      const cards = $$('#board .card');
      const toFlip = cards.filter(el => !el.classList.contains('matched') && !el.classList.contains('flipped'));
      toFlip.forEach(el => el.classList.add('flipped'));
      setTimeout(() => { toFlip.forEach(el => el.classList.remove('flipped')); }, 3000);
    }

    function newGame(){
      const ds = document.getElementById('dataset').value;
      pairTarget = parseInt(document.getElementById('difficulty').value, 10) || 5;
      const limitSel = parseInt(document.getElementById('timelimit').value, 10);
      first = second = null; lock = false; moves = 0; matches = 0; score = 0; combo = 0; updateHUD();
      deck = buildDeck(ds); preloadImages(deck); render();
      startTimer(limitSel);
    }

    // ì´ˆê¸°í™”
    document.getElementById('btn-new').addEventListener('click', newGame);
    document.getElementById('btn-hint').addEventListener('click', hint3sec);
    document.getElementById('dataset').addEventListener('change', newGame);
    document.getElementById('difficulty').addEventListener('change', newGame);
    document.getElementById('timelimit').addEventListener('change', newGame);
    newGame();
  </script>
</body>
</html>
